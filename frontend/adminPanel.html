<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Админ-панель</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f4f4f4; }
    header { background-color: #4CAF50; padding: 20px; color: white; text-align: center; font-size: 24px; }
    .tabs { display: flex; justify-content: center; background-color: #ddd; }
    .tabs button { padding: 14px 20px; background-color: inherit; border: none; cursor: pointer; font-size: 16px; transition: 0.3s; }
    .tabs button:hover { background-color: #ccc; }
    .tabs button.active { background-color: #bbb; }
    .tab-content { display: none; padding: 20px; background-color: white; min-height: 400px; }
    .tab-content.active { display: block; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    th { background-color: #f2f2f2; }
    button.delete { background-color: red; color: white; border: none; padding: 5px 10px; cursor: pointer; }
  </style>
</head>
<body>

<header>Админская панель</header>

<div class="tabs">
  <button class="tab-link active" onclick="openTab(event, 'users')">Пользователи</button>
  <button class="tab-link" onclick="openTab(event, 'products')">Продукты</button>
</div>

<div id="users" class="tab-content active">
  <h2>Управление пользователями</h2>
  <p>Здесь будет управление пользователями.</p>
</div>

<div id="products" class="tab-content">
  <h2>Управление продуктами</h2>
  <div id="product-list">Загрузка...</div>
</div>

<script>
  function openTab(evt, tabName) {
    const tabContents = document.querySelectorAll(".tab-content");
    const tabLinks = document.querySelectorAll(".tab-link");
    tabContents.forEach(content => content.classList.remove("active"));
    tabLinks.forEach(link => link.classList.remove("active"));
    document.getElementById(tabName).classList.add("active");
    evt.currentTarget.classList.add("active");
    if (tabName === 'products') {
      loadProducts();
    }
  }

  async function loadProducts() {
    const response = await fetch('https://localhost:7240/api/products');
    if (!response.ok) {
      document.getElementById('product-list').innerHTML = '<p>Ошибка загрузки продуктов</p>';
      return;
    }
    const products = await response.json();
    let html = '<table><tr><th>Название</th><th>Описание</th><th>Цена</th><th>Действия</th></tr>';
    products.forEach(p => {
      html += `<tr>
        <td>${p.name}</td>
        <td>${p.description}</td>
        <td>${p.price}</td>
        <td><button class="delete" onclick="deleteProduct('${p.id}')">Удалить</button></td>
      </tr>`;
    });
    html += '</table>';
    document.getElementById('product-list').innerHTML = html;
  }

  async function deleteProduct(id) {
    if (!confirm("Вы уверены, что хотите удалить продукт?")) return;
    const response = await fetch(`https://localhost:7240/api/products/${id}`, { method: 'DELETE' });
    if (response.ok) {
      alert('Продукт удалён');
      loadProducts();
    } else if (response.status === 401 || response.status === 403) {
      alert('Нет прав для удаления продукта');
    } else {
      alert('Ошибка при удалении продукта');
    }
  }
</script>

</body>
</html>
